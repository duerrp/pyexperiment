#!/usr/bin/env python
"""A simple example on how to use pyexperiment.

Written by Peter Duerr
"""
import unittest

from pyexperiment import experiment
from pyexperiment import log
from pyexperiment.utils.printers import print_red  # pylint: disable=E0611
from pyexperiment.utils.printers import print_blue  # pylint: disable=E0611

# Python 2.x compatibility
from six.moves import range  # pylint: disable=redefined-builtin, import-error


def example_function(argument):
    """An example function
    """
    log.debug("Call example function with argument: %s",
              argument)
    return argument ** 2


def default():
    """Example experiment that squares a number
    """
    print_red("Experiment started")
    log.debug("Trying to square 42 ten times...")
    for _ in range(10):
        with log.timed("Squaring number"):
            result = example_function(42)

    return result


def print_number(number):
    """Example command that prints a number. Enter one!
    """
    number = int(number)
    print_blue("Welcome to experiment")
    log.info("Experiment started")

    return number


class ExampleTest(unittest.TestCase):
    """Test case for the example experiment
    """
    def test_foo(self):
        """Test something
        """
        self.assertEqual(example_function(2), 4)

    def test_bar(self):
        """Test something else
        """
        self.assertEqual(example_function(3), 9)

if __name__ == '__main__':
    experiment.main(default=default,
                    commands=[print_number],
                    tests=[ExampleTest])
